<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link href="../static/styles.css" rel="stylesheet">  
    <style>
        .center {
            margin-left: auto;
            margin-right: auto;
            text-align: left;
        }
        .center th, .center td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        .center th {
            background-color: #f2f2f2;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/API_portfolio') // Assuming your Flask server is serving the portfolio API at this endpoint
                .then(response => response.json())
                .then(data => {
                    const container = document.querySelector('.container');
                    const table = document.createElement('table');
                    table.className = 'center'; // Add center class to the table

                    // Create table header
                    const thead = document.createElement('thead');
                    const headerRow = document.createElement('tr');
                    ['Coin', 'Amount', 'Price', 'Total'].forEach(headerText => {
                        const th = document.createElement('th');
                        th.textContent = headerText;
                        th.style.width = '300px';
                        headerRow.appendChild(th);
                    });
                    thead.appendChild(headerRow);
                    table.appendChild(thead);

                    // Create table body
                    const tbody = document.createElement('tbody');

                    // Iterate over portfolio items
                    data.portfolio.forEach(item => {
                        const row = document.createElement('tr');
                        ['coin', 'amount', 'price_current', 'total_current'].forEach(key => {
                            const cell = document.createElement('td');
                            cell.textContent = item[key];
                            row.appendChild(cell);
                        });
                        tbody.appendChild(row);
                    });

                    // Add sum holdings row
                    const sumHoldingsRow = document.createElement('tr');
                    const sumHoldingsCell = document.createElement('td');
                    sumHoldingsCell.textContent = 'Stock balance:';
                    sumHoldingsRow.appendChild(sumHoldingsCell);
                    sumHoldingsRow.innerHTML += '<td></td><td></td>'; // Empty cells for Shares and Price
                    const sumHoldingsValueCell = document.createElement('td');
                    sumHoldingsValueCell.textContent = data.sum_holdings.toFixed(2);
                    sumHoldingsRow.appendChild(sumHoldingsValueCell);
                    tbody.appendChild(sumHoldingsRow);

                    // Add cash balance row
                    const cashRow = document.createElement('tr');
                    const cashCell = document.createElement('td');
                    cashCell.textContent = 'Cash balance:';
                    cashRow.appendChild(cashCell);
                    cashRow.innerHTML += '<td></td><td></td>'; // Empty cells for Shares and Price
                    const cashValueCell = document.createElement('td');
                    cashValueCell.textContent = data.cash.cash.toFixed(2);
                    cashRow.appendChild(cashValueCell);
                    tbody.appendChild(cashRow);

                    // Add total balance row
                    const totalRow = document.createElement('tr');
                    const totalCell = document.createElement('td');
                    totalCell.textContent = 'Total balance:';
                    totalRow.appendChild(totalCell);
                    totalRow.innerHTML += '<td></td><td></td>'; // Empty cells for Shares and Price
                    const totalValueCell = document.createElement('td');
                    totalValueCell.textContent = data.total.toFixed(2);
                    totalRow.appendChild(totalValueCell);
                    tbody.appendChild(totalRow);

                    table.appendChild(tbody);

                    container.appendChild(table);
                })
                .catch(error => {
                    console.error('Error fetching API:', error);
                });
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- Table will be inserted here -->
    </div>
</body>
</html>
